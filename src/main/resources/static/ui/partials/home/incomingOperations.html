<div class="row" ng-init="showBody='true';hideWidget='false'"
     ng-hide="hideWidget=='true'">
    <div class="col-md-12">
        <div class="panel panel-danger">
            <div class="panel-heading">
                <ul class="panel-controls pull-left" style="margin-top: 2px;">
                    <button id="close-requests-menu-lower-left" class="mdl-button mdl-js-button mdl-button--icon">
                        <i class="material-icons">more_vert</i>
                    </button>
                    <ul class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
                        for="close-requests-menu-lower-left">
                        <li class="mdl-menu__item" ng-click="showBody=='true' ? showBody='false' : showBody='true'">
                            <span>{{showBody=='true' ? 'اخفاء' : 'اظهار'}}</span>
                        </li>
                        <li class="mdl-menu__item mdl-menu__item--full-bleed-divider" ng-click="hideWidget='true'">
                            <span>حذف</span>
                        </li>
                        <li class="mdl-menu__item" ng-click="fetchThisDay()">
                            <span>حركات المهام الواردة هذا اليوم</span>
                        </li>
                        <li class="mdl-menu__item" ng-click="fetchThisWeek()">
                            <span>حركات المهام الواردة هذا الاسبوع</span>
                        </li>
                        <li class="mdl-menu__item" ng-click="fetchThisMonth()">
                            <span>حركات المهام الواردة هذا الشهر</span>
                        </li>
                        <li class="mdl-menu__item mdl-menu__item--full-bleed-divider" ng-click="fetchThisYear()">
                            <span>حركات المهام الواردة هذا العام</span>
                        </li>
                        <li class="mdl-menu__item" ng-click="refresh()">
                            <span>تحديث البيانات</span>
                        </li>
                    </ul>
                </ul>
                <div class="panel-title-box pull-right">
                    <h3>{{!viewType? 'حركات المهام الواردة حسب الوقت' : viewType}}</h3>
                    <span>حركات المهام الواردة حسب الوقت، ويمكنك التخصيص من القائمة الجانبية</span>
                </div>
            </div>
            <div class="panel-body" ng-show="showBody=='true'">
                <div class="row">
                    <div class="table-responsive">
                        <table st-table="collection" st-safe-src="incomingOperations"
                               class="table table-bordered table-striped">
                            <tbody>
                            <tr ng-repeat="taskOperation in collection | orderBy:date:true">
                                <td>
                                    <table width="100%">
                                        <tbody>
                                        <tr>
                                            <td colspan="1" class="text-right">
                                                <span>المرسل /</span>
                                                <span>
                                                     <a href=""
                                                        ng-click="viewInfo===1?viewInfo=false:viewInfo=1"><strong>{{taskOperation.sender.name}}</strong></a>
                                                </span>
                                                <span> عنوان المهمة / </span>
                                                <span>
                                                     <a href=""
                                                        ng-click="viewInfo===2?viewInfo=false:viewInfo=2"><strong>{{taskOperation.task.title}}</strong></a>
                                                </span>
                                            </td>
                                            <td colspan="1" class="text-left">
                                                <span class="label label-success">
                                                    <timer interval="60000" start-time="taskOperation.date"><span> {{(minutes < 1 && hours < 1 && days < 1 )? 'الآن' : 'منذ'}} </span> {{days > 0 ? days : ''}} {{days > 0 ? 'يوم' : ''}} {{hours > 0 ? hours : ''}} {{hours > 0 ? 'ساعة' : ''}} {{minutes > 0 ? minutes : ''}} {{minutes > 0 ? 'دقيقة' : ''}}</timer>
                                                </span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="1" class="text-right" style="padding: 5px;">
                                                <strong>{{taskOperation.content}}</strong>
                                            </td>
                                            <td colspan="1" class="text-left" style="padding: 10px 0px 10px 0px;">
                                                <ul class="panel-controls pull-left">
                                                    <!--<li>-->
                                                    <!--<a href="" ng-click="delete(taskOperation)"-->
                                                    <!--tooltip-append-to-body="true"-->
                                                    <!--uib-tooltip="حذف">-->
                                                    <!--<span class="fa fa-trash"></span>-->
                                                    <!--</a>-->
                                                    <!--</li>-->
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr ng-if="viewInfo===1">
                                            <td colspan="2">
                                                <table class="table table-bordered">
                                                    <tbody>
                                                    <tr>
                                                        <td colspan="2" class="success"><strong>بيانات المرسل</strong>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>الاسم</td>
                                                        <td>{{taskOperation.sender.name}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>البريد الإلكتروني</td>
                                                        <td>{{taskOperation.sender.email}}</td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr ng-if="viewInfo===2">
                                            <td colspan="2">
                                                <table class="table table-bordered">
                                                    <tbody>
                                                    <tr>
                                                        <td colspan="2" class="success"><strong>بيانات المهمة</strong>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>رقم المهمة</td>
                                                        <td>{{taskOperation.task.code}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>عنوان المهمة</td>
                                                        <td>{{taskOperation.task.title}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>تفاصيل المهمة</td>
                                                        <td>{{taskOperation.task.content}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>تاريخ الإنشاء</td>
                                                        <td>{{taskOperation.task.startDate | kdate: 'yyyy-mm-dd' : 'ar'
                                                            :
                                                            'ummalqura'}}
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>تاريخ التسليم</td>
                                                        <td>{{taskOperation.task.endDate | kdate: 'yyyy-mm-dd' : 'ar' :
                                                            'ummalqura'}}
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>جهة التكليف</td>
                                                        <td>{{task.person.nickname}} {{taskOperation.task.person.name}}
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>الموظفون</td>
                                                        <td>
                                                            <span class="label label-info"
                                                                  ng-repeat="to in taskOperation.task.taskTos"
                                                                  style="margin: 2px">{{to.person.name}}</span>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                            <tr class="blank_row" style="height: 10px !important; background-color: #FFFFFF;"
                                ng-show="!collection || collection.length ==0">
                                <td colspan="1">لا توجد نتائج</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>